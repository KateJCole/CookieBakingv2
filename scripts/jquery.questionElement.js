/*! -- File: jquery.questionElement.js ( Input 0 ) -- */
!function(c){var d=function(a,b){this.options=b;this.showCorrectAtEnd=this.allowInlineFeedback=!0;this.$el=c(a);this.initDB(b.outline);this.initSubscribers();this.attempts=this.score=0;this.type=b.outline.elementtype;this.setResponsive();return this};d.DEFAULTS={accessible:!0,passingMark:50,clickEvents:"click",outline:{},actionAPI:null,feedback:{correct:"",partial:"",incorrect:""},strings:{correct:"",partial:"",incorrect:"",submit:"Submit",tstchoicesLabel1:"You cannot choose more than",tstchoicesLabel2:"selections.",
showResult:"Show Answers",showGiven:"Show Submission",confirmQuestionNoSelection:"Are you sure you wish to submit this question without providing any answers?"}};d.constant=Object.freeze({screenReader:{visible:{tabindex:"1","aria-hidden":"false"},hidden:{tabindex:"-1","aria-hidden":"true"}}});d.prototype={initDB:function(a){this.db=function(){var a={},b={dragdrop_id:{}};return{store:function(c){a[c.id]=c;b.dragdrop_id[c.dragdrop_id]=a[c.id]},get:function(b){return a[b]},getByKey:function(a,c){return b[a][c]},
remove:function(b){delete a[item.id]},clear:function(){a={}},getLength:function(){return Object.keys(a).length}}}();var b=c.proxy(function(a){this.db.store(a);for(var c in a.elements)b(a.elements[c])},this);b(a)},initSubscribers:function(){var a=this;c("input",this.$el).on("focus",function(a){c(this).closest(".input-group-addon").addClass("focus-within")});c("input",this.$el).on("blur",function(a){c(".input-group-addon.focus-within").removeClass("focus-within")});this.$el.on(this.options.clickEvent,
".btn.retake",function(){c(this).hide();c(this).siblings(".submit").show();a.resetOptionClasses();a.resetOptionState();var b=a.$el.find(".dki-question-option input").first();b[0]&&b[0].focus();a.onRetake();return!1});this.$el.on("change","input",function(){a.onInputChange.call(a,c(this))});this.$el.on(this.options.clickEvent,".btn.submit:not(.showAnswers)",function(){c(this).hasClass("disabled")||a.submit()});this.$el.on(this.options.clickEvent,".btn.submit.showAnswers",function(){c(this).toggleClass("full");
c(this).hasClass("full")?(c(this).html(a.options.strings.showGiven),a.showCorrectAnswers()):(c(this).html(a.options.strings.showResult),a.showGivenAnswers())});this.$el.on(this.options.clickEvent,".dki-question-option .input-group-addon",function(b){if(b.target==this)return c(this).find("input").trigger(a.options.clickEvent),b.stopPropagation(),!1});this.$el.on(QuestionElementEvents.correct,function(b,c){a.allowInlineFeedback&&a.showFeedback("correct",c.score)});this.$el.on(QuestionElementEvents.partiallyCorrect+
" "+QuestionElementEvents.attemptPartiallyCorrect+" "+QuestionElementEvents.incorrect+" "+QuestionElementEvents.attemptIncorrect,function(b,c){a.allowInlineFeedback&&a.showFeedback("incorrect",c.score)});c(document).on(DKI.ContentPage.events.started,function(b,c){!player.isSinglePage&&c.page.id!=a.options.outline.pageid||"dragTheWordQuestion"!=a.type||(a.$el.find(".options span").droppable("option","disabled",!1),a.$el.find(".answers span").draggable("option","disabled",!1))})},hasRemainingAttempts:function(){return this.attempts<
parseInt(this.options.outline.parameters.config.attempts)},getRemainingAttempts:function(){return Math.max(this.options.outline.parameters.config.attempts-this.attempts,0)},disableInputs:function(){this.$el.find("input, select").prop("disabled",!0);this.$el.find(".input-group-addon").addClass("disabled")},enableInputs:function(){this.$el.find("input, select").prop("disabled",!1);this.$el.find(".input-group-addon").removeClass("disabled")},submit:function(a){this.hasRemainingAttempts()&&this.checkIfAnswered(c.proxy(function(){a&&
a();this.attempts+=1;this.disableInputs();var b=this.scoreQuestion();this.setState(b);this.variableUpdate(b)},this))},hasSelection:function(){return!1},checkIfAnswered:function(a){(this.hasSelection()||confirm(this.options.strings.confirmQuestionNoSelection))&&a()},setState:function(a){var b=this.$el.find(".submit").removeClass("showAnswers");this.hasRemainingAttempts()&&100!=a?(b.hide(),b.siblings(".retake").css("display","inline-block")[0].focus()):(100!=a&&"trueFalseQuestion"!=this.type&&"multipleChoiceQuestion"!=
this.type?b.addClass("showAnswers").show().html(this.options.strings.showResult):b.addClass("disabled").show().attr("tabindex","0"),b.siblings(".retake").hide())},resetSubmitButton:function(){var a=this.$el.find(".btn.submit");a.css("display","block").siblings(".retake").css("display","none");a.removeClass("showAnswers disabled").html(this.options.strings.submit)},resetOptionClasses:function(){this.$el.find(".dki-element-content").removeClass("multiChoiceCorrectResponse correct incorrect");this.$el.find(".correctOutline").removeClass("correctOutline")},
resetOptionState:function(){this.$el.find(".dki-element-content .input-group").removeClass("checked").find("input").prop("checked",!1).prop("disabled",!1)},variableUpdate:function(a){this.options.outline.parameters.config.variable_name&&contentApi&&contentApi.setData(this.options.outline.parameters.config.variable_name,a)},fireScoredEvent:function(a,b){this.$el.trigger(QuestionElementEvents.attempted,b);a&&100!=b.score||this.$el.trigger(QuestionElementEvents.submitted,b);b.score>=this.options.passingMark?
this.$el.trigger(QuestionElementEvents.correct,b):0!=b.score?a?this.$el.trigger(QuestionElementEvents.attemptPartiallyCorrect,b):this.$el.trigger(QuestionElementEvents.partiallyCorrect,b):a?this.$el.trigger(QuestionElementEvents.attemptIncorrect,b):this.$el.trigger(QuestionElementEvents.incorrect,b)},setResponsive:function(){DKI.apply(this.__proto__,Object.create(d[this.options.responsive?"responsive":"fixed"]))},onRetake:function(){this.$el.trigger(QuestionElementEvents.retry);this.enableInputs()},
destroy:function(){},onInputChange:function(a){this.$el.find(".input-group").removeClass("checked");c(".input-group input:checked",this.$el).each(function(){c(this).closest(".input-group").addClass("checked")})},reset:function(){this.resetOptionState();this.resetOptionClasses();this.resetSubmitButton();this.$el.find(".feedback").removeClass("showFeedback");this.attempts=0},export:function(){},import:function(){},setTestConfig:function(a){this.options.outline.parameters.config.attempts=a.attempts;
this.allowInlineFeedback=a.allowInlineFeedback;this.showCorrectAtEnd=a.showCorrectAtEnd}};d.responsive={showFeedback:function(a,b){var c=this;if((this.options.outline.parameters.config.showFeedback||this.options.outline.parameters.config.showScore)&&(!this.hasRemainingAttempts()||"correct"===a)){var f="";this.options.outline.parameters.config.showScore&&(f+='\x3cdiv class\x3d\'gauge-wrapper\'\x3e\x3cspan class\x3d\'gauge\'\x3e\x3cdiv\x3e\x3cdiv class\x3d"overlay"\x3e\x3cdiv tabindex\x3d"1" class\x3d"text dki-element-text"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mask full"\x3e\x3cdiv class\x3d"fill"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mask half"\x3e\x3cdiv class\x3d"fill"\x3e\x3c/div\x3e\x3cdiv class\x3d"fill fix"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/span\x3e\x3c/div\x3e');
var d=this.options.outline.parameters.config.useProjectDefault?"\x3cdiv style\x3d'text-align:center'\x3e":"\x3cdiv\x3e";this.options.outline.parameters.config.showFeedback&&(f+="\x3cdiv tabindex\x3d'1'\x3e"+d+this.options.feedback[a]+"\x3c/div\x3e\x3c/div\x3e");var g=this.$el.find(".feedback").html(f).addClass("showFeedback");if(this.options.outline.parameters.config.showScore){var h=g.find(".gauge \x3e div").addClass(a);h.RadialGauge({parentSelector:".gauge",startingPosition:0,showText:!1,asPercent:!0,
ringSize:.25});g.find(".gauge \x3e div").RadialGauge("resize")}setTimeout(function(){c.options.outline.parameters.config.showScore&&h.RadialGauge("setRotation",b.toFixed(0));var a=g.find("*[tabindex\x3d'1']");a[0]&&a[0].focus()},200)}}};d.fixed={showFeedback:function(a,b){if(this.options.feedback[a]&&this.options.outline.parameters.config.showFeedback){switch(a){case "correct":b="success";break;case "incorrect":b="danger";break;default:b="warning"}DKI.PopupPanel.show({modal:!0,style:b,title:this.options.strings[a],
html:this.options.feedback[a],popupType:{type:"pop",mod:""},onHide:function(){var a=[];a[0]&&a[0].focus()}})}}};d.TrueFalseQuestion=function(a,b){this.super=d;this.super.apply(this,arguments);return this};d.TrueFalseQuestion.prototype=DKI.apply(Object.create(d.prototype),{getCorrectAnswer:function(){return"t"===this.options.outline.parameters.config.correctAnswer},showGivenAnswers:function(){this.resetOptionClasses();this.scoreQuestion(!0)},showCorrectAnswers:function(){var a=[],b=this;this.$el.find("input").each(function(){if(b.optionIsCorrect(this))return a.push(this),
!1});this.showInlineFeedback(a,[],!0)},optionIsCorrect:function(a){return c(a).val()===this.getCorrectAnswer().toString()},scoreQuestion:function(a){var b=this.$el.find("input"),e=b.filter(":checked"),f=[],d=[],g=this;c.each(b,function(){c(this).checked()&&(g.optionIsCorrect(this)?f.push(this):d.push(this))});b=f.length?100:0;this.showInlineFeedback(f,d);a||this.fireScoredEvent(this.getRemainingAttempts(),{score:b,correct:[this.getCorrectAnswer().toString()],selected:[e.val()]});return b},showInlineFeedback:function(a,
b,e){if(this.options.outline.parameters.config.showFeedback||e)a=0==this.getRemainingAttempts()?c(a):c(a).filter(":checked"),b=0==this.getRemainingAttempts()?c(b):c(b).filter(":checked"),a.each(function(){c(this).closest(".dki-element-content").addClass("correct multiChoiceCorrectResponse")}),b.each(function(){c(this).closest(".dki-element-content").addClass("incorrect")})},elementStart:function(){c("h4, .question-description, .btn.submit, .btn.retake, .dki-element-content input",this.$el).attr({tabindex:this.options.accessible?
"1":"-1"})},hasSelection:function(){return 0!==this.$el.find("input:checked").length}});d.MultipleChoiceQuestion=function(a,b){this.super=d;c(a).data("dki.MultipleChoiceQuestion",this.super.apply(this,arguments));this.setup();return this};d.MultipleChoiceQuestion.prototype=DKI.apply(Object.create(d.prototype),{setup:function(){this.$el.find(".question-option-image-magnifier").fancybox({transitionIn:"elastic",transitionOut:"elastic",speedIn:600,speedOut:200,overlayShow:!1,lang:"en",i18n:{en:{CLOSE:DKI.strings.runtime.buttonLabelClose,
NEXT:DKI.strings.runtime.buttonLabelNext,PREV:DKI.strings.index.previousButtonLabel}},afterLoad:function(a,b){DKI.enforceFocus(this.$slide.closest(".fancybox-inner"));this.$slide.closest(".fancybox-inner").find(".fancybox-infobar").attr("aria-hidden",!0);this.$slide.closest(".fancybox-container").attr("aria-label","Popup")},beforeShow:function(a){a=a.current.$slide.closest(".fancybox-inner");a.find("*[tabindex\x3d'1']").first()[0].focus();a.find(".fancybox-button").attr("tabindex",1).filter(".disabled").attr("tabindex",
-1)},btnTpl:{close:'\x3cbutton tabindex\x3d"1" aria-label\x3d"{{CLOSE}}" data-fancybox-close class\x3d"fancybox-button fancybox-button--close" title\x3d"{{CLOSE}}" style\x3d"opacity:1 !important;"\x3e\x3csvg tabindex\x3d"-1" aria-hidden\x3d"true" viewBox\x3d"0 0 40 40"\x3e\x3cpath d\x3d"M10,10 L30,30 M30,10 L10,30" /\x3e\x3c/svg\x3e\x3c/button\x3e',arrowLeft:'\x3cbutton tabindex\x3d"1" type\x3d"button" aria-label\x3d"{{PREV}}" data-fancybox-prev class\x3d"fancybox-button fancybox-button--arrow_left" title\x3d"{{PREV}}" href\x3d"javascript:;"\x3e\x3csvg tabindex\x3d"-1" aria-hidden\x3d"true" viewBox\x3d"0 0 40 40"\x3e\x3cpath d\x3d"M18,12 L10,20 L18,28 M10,20 L30,20"\x3e\x3c/path\x3e\x3c/svg\x3e\x3c/button\x3e',
arrowRight:'\x3cbutton tabindex\x3d"1" type\x3d"button" aria-label\x3d"{{NEXT}}" data-fancybox-next class\x3d"fancybox-button fancybox-button--arrow_right" title\x3d"{{NEXT}}" href\x3d"javascript:;"\x3e\x3csvg tabindex\x3d"-1" aria-hidden\x3d"true" viewBox\x3d"0 0 40 40"\x3e\x3cpath d\x3d"M10,20 L30,20 M22,12 L30,20 L22,28"\x3e\x3c/path\x3e\x3c/svg\x3e\x3c/button\x3e'}});this.setHeights()},setHeights:function(){c(".question-option-image-wrapper").length&&QuestionElementUtility.syncOptionHeightsToTallest(this.$el.find(".input-group"))},
onInputChange:function(a){c(".input-group input:checked",this.$el).length>this.options.outline.parameters.config.maxSelections?(a.prop("checked",!1),alert(this.options.strings.tstchoicesLabel1+" "+this.options.outline.parameters.config.maxSelections+" "+this.options.strings.tstchoicesLabel2)):this.super.prototype.onInputChange.apply(this,arguments)},optionIsCorrect:function(a){return this.db.get(c(a).data("id")).parameters.config.correct},optionAnswerIsCorrect:function(a){return this.optionIsCorrect(a)&&
c(a).checked()},showGivenAnswers:function(){this.resetOptionClasses();this.scoreQuestion(!0)},showCorrectAnswers:function(){var a=this;this.$el.find("input").each(function(){a.optionIsCorrect(this)&&c(this).closest(".dki-element-content").addClass("multiChoiceCorrectResponse")})},export:function(){var a={selectedIds:[]};c(".input-group input:checked",this.$el).each(function(){a.selectedIds.push(c(this).closest(".dki-questionOption-element").data("id"))});return a},import:function(a){var b=this;c.each(a.selectedIds,
function(){var a=b.$el.find(".dki-questionOption-element[data-id\x3d"+this+"]");a.find("input").prop("checked",!0);a.find(".input-group").addClass("checked")})},scoreQuestion:function(a,b,c){"undefined"!=typeof c&&c&&this.attempts++;c=this.getScoringDetails(a,b);b||this.showInlineFeedback(c.correct,c.incorrect);a||this.fireScoredEvent(this.getRemainingAttempts(),{score:c.score,correct:c.correctPattern,selected:c.submittedPattern});return c.score},getScoringDetails:function(a,b){a=this.$el.find("input");
var e=this,f=0,d=0,g=[],h=[],l=[],m=[];c.each(a,function(a,b){b=e.db.get(c(this).data("id"));var q=e.optionIsCorrect(this),p=e.optionAnswerIsCorrect(this);f+=q?1:0;p?g.push(this):!1;!p&&c(this).checked()?h.push(this):!1;var n=c(this).closest(".dki-element-content");q?l.push({short:e.options.outline.parameters.config.numbering?n.find("span.numbering").html().replace(")",""):(a+1).toString(),long:n.find("label .dki-element-text").html(),outline:b}):c(this).checked()&&d--;c(this).checked()&&m.push({short:e.options.outline.parameters.config.numbering?
n.find("span.numbering").html().replace(")",""):(a+1).toString(),long:n.find("label .dki-element-text").html(),outline:b});p&&d++});0>=d?(a=0,0==d&&0==f&&(a=100)):a=d/f*100;b||this.showInlineFeedback(g,h);return{totalCorrect:f,correct:g,incorrect:h,correctPattern:l,submittedPattern:m,score:a}},hasInlineFeedback:function(){return this.options.outline.parameters.config.showFeedback},showInlineFeedback:function(a,b,e){if(this.hasInlineFeedback()||e){a=0==this.getRemainingAttempts()?c(a):c(a).filter(":checked");
b=0==this.getRemainingAttempts()?c(b):c(b).filter(":checked");var f=this;a.each(function(){c(this).closest(".dki-element-content").addClass("correct")});b.each(function(){f.db.get(c(this).data("id"));c(this).closest(".dki-element-content").addClass("incorrect")});f.showCorrectAtEnd&&0==this.getRemainingAttempts()&&f.showCorrectAnswers()}},elementStart:function(){c("h4, .question-description, input, .btn.submit, .btn.retake",this.$el).attr({tabindex:this.options.accessible?"1":"-1"})},hasSelection:function(){return 0!==
this.$el.find("input:checked").length},getSelectedOptions:function(){var a=this,b=[];this.$el.find("input").filter(":checked").each(function(){b.push(a.db.get(c(this).data("id")))});return b}});d.MultiplePulldownQuestion=function(a,b){this.super=d;this.super.apply(this,arguments);this.setup();return this};d.MultiplePulldownQuestion.prototype=DKI.apply(Object.create(d.prototype),{setup:function(){this.$el.on("change","select",function(){c(this).attr("aria-label",c(this).val()).closest(".input-group").addClass("checked")});
var a=this;this.$el.find("select").each(function(){var b=a.db.getByKey("dragdrop_id",c(this).data("dragdrop-id")),e=this,b=DKI.utility.shuffle(b.meta.split("/,"));c(e).append("\x3coption val\x3d''\x3e\x3c/option\x3e");c.each(b,function(a,b){c(e).append("\x3coption val\x3d'"+b+"'\x3e"+b+"\x3c/option\x3e")})})},optionIsCorrect:function(a){return c("\x3cdiv/\x3e").append(this.getCorrectOptionValue(a)).text().trim()===c(a).val().trim()},getCorrectOptionValue:function(a){a=this.db.getByKey("dragdrop_id",
c(a).data("dragdrop-id"));return a.meta.split("/,")[0].trim()},showGivenAnswers:function(){var a=this;this.resetOptionClasses();this.$el.find("select").each(function(){var b=c(this).data("dragdrop-id");"undefined"!==typeof a.answered[b]&&c(this).val(a.answered[b])});this.scoreQuestion(!0)},showCorrectAnswers:function(){var a=this.$el.find("select"),b=this,e=[];this.answered||(this.answered={},a.each(function(){b.answered[c(this).data("dragdrop-id")]=c(this).val()}));this.resetOptionClasses();a.each(function(){e.push(this);
c(this).val(b.getCorrectOptionValue(this))});this.showInlineFeedback(e,[],!0)},scoreQuestion:function(a){var b=this.$el.find("select"),e=this,d=0,k=[],g=[],h=[],l=[];c.each(b,function(a,b){a=e.db.getByKey("dragdrop_id",c(this).data("dragdrop-id"));optionCorrect=e.optionIsCorrect(this);d+=optionCorrect?1:0;optionCorrect?k.push(this):g.push(this);c(this).closest(".dki-element-content");h.push(a.meta.split("/,")[0]);l.push(c(this).val())});b=d/this.options.outline.elements.length*100;this.showInlineFeedback(k,
g);var m=c("\x3cdiv\x3e").html(this.$el.find(".options").html());m.find("span.dki-question-option").replaceWith("_____");a||this.fireScoredEvent(this.getRemainingAttempts(),{score:b,correct:h,selected:l,body:m.text()});return b},showInlineFeedback:function(a,b,e){if(this.options.outline.parameters.config.showFeedback||e){var d=this;c.each(a,function(){c(this).closest(".dki-question-option").addClass("correct multiChoiceCorrectResponse")});c.each(b,function(){var a="incorrect";d.db.getByKey("dragdrop_id",
c(this).data("dragdrop-id")).parameters.config.correct&&!c(this).checked()&&(a="multiChoiceCorrectResponse");c(this).closest(".dki-question-option").addClass(a)})}},clearSubmitted:function(){this.$el.find("select").val("").prop("disabled",!1)},onRetake:function(){this.super.prototype.onRetake.call(this);this.clearSubmitted()},reset:function(){this.super.prototype.reset.call(this);delete this.answered;this.clearSubmitted()},elementStart:function(){c("h4, .options, .btn.submit, .btn.retake, .dki-element-content select.pulldown_option",
this.$el).attr({tabindex:this.options.accessible?"1":"-1"})},hasSelection:function(){for(var a=this.$el.find("select").toArray(),b=0;b<a.length;b++)if(""==c(a[b]).val())return!1;return!0}});d.FillInTheBlanksQuestion=function(a,b){this.super=d;this.super.apply(this,arguments);this.setup();return this};d.FillInTheBlanksQuestion.prototype=DKI.apply(Object.create(d.prototype),{setup:function(){this.$el.on("change","input",function(){c(this).attr("aria-label",c(this).val()).closest(".input-group").addClass("checked")})},
optionIsCorrect:function(a){var b=c(a).val().trim(),b=this.options.outline.parameters.config.caseSensitive?b:b.toLowerCase();return~jQuery.inArray(b,this.getCorrectOptionValues(a))?!0:!1},getCorrectOptionValues:function(a){a=this.db.getByKey("dragdrop_id",c(a).data("dragdrop-id"));var b=this;return a.meta.split("/,").map(function(a){return(b.options.outline.parameters.config.caseSensitive?a:a.toLowerCase()).trim()})},showGivenAnswers:function(){var a=this;this.resetOptionClasses();this.$el.find("input[type\x3d'text']").each(function(){var b=
c(this).data("dragdrop-id");"undefined"!==typeof a.answered[b]&&c(this).val(a.answered[b])});this.scoreQuestion(!0)},showCorrectAnswers:function(){var a=this.$el.find("input[type\x3d'text']"),b=this,e=[];this.answered||(this.answered={},a.each(function(){b.answered[c(this).data("dragdrop-id")]=c(this).val()}));this.resetOptionClasses();a.each(function(){e.push(this);c(this).val(b.getCorrectOptionValues(this)[0])});this.showInlineFeedback(e,[],!0)},scoreQuestion:function(a){var b=this.$el.find("input"),
e=this,d=0,k=[],g=[],h=[],l=[];c.each(b,function(a,b){a=e.optionIsCorrect(this);d+=a?1:0;a?k.push(this):g.push(this);c(this).closest(".dki-element-content");h.push(e.getCorrectOptionValues(this));l.push(c(this).val())});b=d/this.options.outline.elements.length*100;this.showInlineFeedback(k,g);var m=c("\x3cdiv\x3e").html(this.$el.find(".options").html());m.find("span.dki-question-option").replaceWith("_____");a||this.fireScoredEvent(this.getRemainingAttempts(),{score:b,correct:h,selected:l,body:m.text()});
return b},showInlineFeedback:function(a,b,e){if(this.options.outline.parameters.config.showFeedback||e){var d=this;c.each(a,function(){c(this).closest(".dki-question-option").addClass("correct multiChoiceCorrectResponse")});c.each(b,function(){var a="incorrect";d.db.getByKey("dragdrop_id",c(this).data("dragdrop-id")).parameters.config.correct&&!c(this).checked()&&(a="multiChoiceCorrectResponse");c(this).closest(".dki-question-option").addClass(a)})}},clearSubmitted:function(){this.$el.find("input").val("").prop("disabled",
!1)},onRetake:function(){this.super.prototype.onRetake.call(this);this.clearSubmitted()},reset:function(){this.super.prototype.reset.call(this);delete this.answered;this.clearSubmitted()},elementStart:function(){c(".btn.submit, .btn.retake, input, h4, .options",this.$el).attr({tabindex:this.options.accessible?"1":"-1"})},hasSelection:function(){for(var a=this.$el.find("input[type\x3d'text']").toArray(),b=0;b<a.length;b++)if(""==c(a[b]).val())return!1;return!0}});d.ClickTheWordQuestion=function(a,
b){this.super=d;this.super.apply(this,arguments);this.setup();return this};d.ClickTheWordQuestion.prototype=DKI.apply(Object.create(d.prototype),{setup:function(){var a=this;this.$el.on("click",".options:not(.submitted) span",function(){if(a.getCurrentSelectedCount()<a.answers.length||c(this).hasClass("selected"))c(this).toggleClass("selected"),a.setCounter()});var b=this.$el.find(".options").attr({"aria-multiselectable":"true",role:"listbox"}).find("span");this.options.accessible&&(b.first().attr("tabindex",
"1"),b.on("keyup",function(a){var b="";switch(a.which){case 37:case 40:b="prev";break;case 39:case 38:b="next"}""!=b&&(a=c(this)[b]("span"),a.length&&(a.attr("tabindex","1")[0].focus(),c(this).attr("tabindex","-1")))}));this.answers=b.filter(".answer");this.answers.removeClass("answer");this.options.responsive&&(this.scrollWith=DKI.func.scrollWith(this.$el.find(".info"),this.$el,{offsetTop:parseInt(c("body").css("margin-top").replace("px"),10),offsetBottom:125,onWinResize:function(a){a.offsetTop=
parseInt(c("body").css("margin-top").replace("px"),10)}}),this.scrollWith.start());this.setCounter()},getCurrentSelectedCount:function(){return this.$el.find("span.selected").length},setCounter:function(){this.counter||(this.counter=this.$el.find(".counter"));this.counter.html(this.getCurrentSelectedCount()+"/"+this.answers.length)},spanifyMeta:function(){},showGivenAnswers:function(){this.answers.removeClass("correctOutline")},showCorrectAnswers:function(){this.answers.addClass("correctOutline")},
scoreQuestion:function(a){var b=this.answers,c=b.filter(".selected");this.showInlineFeedback(c,this.$el.find("span.selected").map(function(a,b){if(0==c.filter(b).length)return b}));b=c.length/b.length*100;a||this.fireScoredEvent(this.getRemainingAttempts(),{score:b,correct:[c]});return b},showInlineFeedback:function(a,b,c){this.options.outline.parameters.config.showFeedback&&(a.addClass("dki-element-content dki-question-option correct multiChoiceCorrectResponse"),b.addClass("dki-element-content dki-question-option incorrect"),
this.hasRemainingAttempts()||this.answers.addClass("correctOutline"))},submit:function(a){d.prototype.submit.call(this,c.proxy(function(){this.$el.find(".options").addClass("submitted")},this))},clearSubmitted:function(){this.$el.find(".options").removeClass("submitted").find(".selected").removeClass("selected dki-element-content dki-question-option")},onRetake:function(){this.super.prototype.onRetake.call(this);this.clearSubmitted()},reset:function(){this.super.prototype.reset.call(this);this.clearSubmitted()},
destroy:function(){this.scrollWith&&(this.scrollWith.stop(),this.scrollWith=null)},elementStart:function(){c(".btn.submit, .btn.retake, .info h4",this.$el).attr({tabindex:this.options.accessible?"1":"-1"})},hasSelection:function(){return this.$el.find(".options .selected").length?!0:!1}});d.DragTheWordQuestion=function(a,b){this.super=d;this.super.apply(this,arguments);this.answers=b.outline.answers;this.setup();return this};d.DragTheWordQuestion.prototype=DKI.apply(Object.create(d.prototype),{setup:function(){var a=
this;this.$el.on("click",".answerNav:not(.disabled)",function(){var b=a.$el.find(".answers"),e=b.find(".selected"),d=c(e.get(0));c(this).hasClass("fa-chevron-right")?e.get(1)&&(b.prepend(c(e.get(1)).detach()),b.append(d.detach())):b.prepend(b.find(".selected").last().detach());b.children().get(0).focus()});this.$el.on("keydown",".answerPool",function(a){39==a.which?c(this).find(".answerNav.fa-chevron-right").trigger("click"):37==a.which&&c(this).find(".answerNav.fa-chevron-left").trigger("click")});
this.$el.on("click",".answerPool.selectAnswer .selected, .options span",function(){var b=a.$el.find(".info .answerPool").data("toSelect");if(b&&b[0]!==this){var d=c(this);b.hasClass("selected")&&(d=b,b=c(this));if(!d.hasClass("answer"))return c(this).parent().hasClass("answers")||c(this).addClass("moved"),b=a.setDrop(d,b),a.setAnswerSelectMode(!1),b[0].focus(),!1}});this.$el.on("click",".options span",function(){if(c(this).parent()[0]&&!c(this).hasClass("moved")&&(a.setAnswerSelectMode(!0,c(this)),
!c(this).hasClass("selected"))){var b=a.$el.find(".info .answerPool .selected").get(0);b&&b.focus()}c(this).removeClass("moved")});this.setupAnswerPool();this.options.responsive&&(this.scrollWith=DKI.func.scrollWith(this.$el.find(".info"),this.$el,{offsetTop:parseInt(c("body").css("margin-top").replace("px"),10),offsetBottom:125,onWinResize:function(a){a.offsetTop=parseInt(c("body").css("margin-top").replace("px"),10)}}),this.scrollWith.start());this.initInteractions();this.setCounter()},setAnswerSelectMode:function(a,
b){this.$el.find(".info .answerPool")[a?"addClass":"removeClass"]("selectAnswer").data("toSelect",a?b:null).find(".selected").attr(d.constant.screenReader[a?"visible":"hidden"])},getCurrentSelectedCount:function(){return this.$el.find(".options span.selected").length},setupAnswerPool:function(){var a=this.$el.find(".info .answers").html(""),b=a.closest(".answerPool");c.each(DKI.utility.shuffle(this.answers.slice(0)),function(b,c){a.append("\x3cspan class\x3d'selected answerDrag'\x3e"+c+"\x3c/span\x3e")});
var d=a.find(".answerDrag").first().outerHeight(!0),d=Math.max(d,parseInt(b.css("min-height")));b.css("min-height",d)},disableNav:function(){this.$el.find(".answerNav").addClass("disabled")},enabledNav:function(){this.$el.find(".answerNav").removeClass("disabled")},initInteractions:function(){var a=!player.isSinglePage&&contentApi.getPageID()!=this.options.outline.pageid,b=this;this.$el.find(".answers span").draggable({disabled:a,helper:"clone",appendTo:"#content_"+this.options.outline.id,start:function(a,
b){b.helper.css({"z-index":15,cursor:"grabbing"});c(this).css("opacity",0)},stop:function(a,b){c(this).css("opacity","")}}).droppable({accept:".answerDrag",tolerance:"pointer",drop:function(a,d){b.setDrop(d.draggable,c(this))},disabled:!1});this.$el.find(".options span").droppable({accept:".answerDrag",tolerance:"pointer",drop:function(a,d){b.setDrop(d.draggable,c(this))},disabled:a})},setDrop:function(a,b){if(b.hasClass("selected")){var c=a.html();a.html(b.html());b.html(c);return b}a.data("from")&&
(a.before(a.data("from")),a.data("from",""));b.before(a.detach());a.data("from",b.detach());this.setCounter();1===this.$el.find(".answers .selected").length&&this.disableNav();return a},setCounter:function(){this.counter||(this.counter=this.$el.find(".counter"));this.counter.html(this.getCurrentSelectedCount()+"/"+this.answers.length)},disableQuestion:function(){var a=this.$el.find(".answer,.selected");a.filter(".ui-draggable").draggable("destroy");a.filter(".ui-droppable").droppable("destroy");this.$el.find(".info").addClass("ended");
this.options.responsive&&this.scrollWith.stop(!0)},showGivenAnswers:function(){var a=this;this.$el.find(".options span").each(function(b,d){c(this).html(a.answered[b])});this.resetOptionClasses();this.scoreQuestion(!0)},showCorrectAnswers:function(){var a=this,b=this.$el.find(".options span");this.answered||(this.answered=[],b.each(function(){a.answered.push(c(this).text())}));b.each(function(b,d){c(this).html(a.answers[b])});this.resetOptionClasses();this.scoreQuestion(!0)},scoreQuestion:function(a){var b=
this.answers,d=this.$el.find(".options span"),f=[],k=[];d.each(function(a,d){if(c(this).hasClass("answerDrag")&&c(this).text()===b[a])return f.push(c(this)),!0;k.push(c(this))});this.disableQuestion();this.showInlineFeedback(f,k);var g=f.length/b.length*100;a||this.fireScoredEvent(this.getRemainingAttempts(),{score:g,correct:f,selected:d.toArray().map(function(a){return c(a).text()})});return g},showInlineFeedback:function(a,b,d){if(this.options.outline.parameters.config.showFeedback||d)c(a).map(function(){return this.toArray()}).addClass("selectec dki-element-content dki-question-option correct multiChoiceCorrectResponse").removeClass("answer"),
c(b).map(function(){return this.toArray()}).addClass("selected dki-element-content dki-question-option incorrect").removeClass("answer")},submit:function(a){d.prototype.submit.call(this,c.proxy(function(){this.$el.find(".options").addClass("submitted")},this))},clearSubmitted:function(){this.$el.find(".options span").attr("class","answer border-only fa fa-bullseye").html("");this.setupAnswerPool();this.initInteractions();this.setCounter();this.enabledNav();this.$el.find(".info").removeClass("ended")},
onRetake:function(){this.super.prototype.onRetake.call(this);this.clearSubmitted();this.options.responsive&&this.scrollWith.start()},reset:function(){this.super.prototype.reset.call(this);this.clearSubmitted()},destroy:function(){this.scrollWith&&(this.scrollWith.stop(),this.scrollWith=null)},elementStart:function(){c(".btn.submit, .btn.retake, .info h4, .options, .options .answer",this.$el).attr({tabindex:this.options.accessible?"1":"-1"})},hasSelection:function(){return this.$el.find(".answerPool .answers").children().length?
!1:!0}});var r=function(a,b){var c=b.outline.elementtype,c=c.charAt(0).toUpperCase()+c.slice(1);return d[c]?new d[c](a,b):new d(a,b)};c.fn.QuestionElement=function(a){var b=a,e=Array.prototype.slice.call(arguments,1);return this.each(function(){var f=c(this),k=c(this).data("dki.QuestionElement");options=c.extend(!0,{},d.DEFAULTS,"object"===typeof b&&b);if("string"===typeof a&&!k)return!1;k?"string"===typeof a&&(f=c(this).data("dki.QuestionElement"))&&f[a]&&f[a].apply(c(this).data("dki.QuestionElement"),
e):f.data("dki.QuestionElement",r(this,options))})};c.fn.QuestionElement.Constructor=d}(window.jQuery);QuestionElementEvents={submitted:"SUBMIT",attempted:"ATTEMPT",correct:"CORRECT",incorrect:"INCORRECT",partiallyCorrect:"PARTIALLY_CORRECT",attemptPartiallyCorrect:"ATTEMPT_PARTIALLY_CORRECT",attemptIncorrect:"ATTEMPTY_INCORRECT",retry:"RETRIED"};
QuestionElementUtility={syncOptionHeightsToTallest:function(c){var d=0;c.css("min-height","").each(function(){d=Math.max(d,$(this).outerHeight())});c.css("min-height",d)}};